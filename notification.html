<!doctype html>
<html>
<head>
<title>L'équipe.fr Notification</title>
<script type="text/javascript" src="jquery-1.4.2.js"></script>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<style type="text/css">
a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

body {
	color: black;
	font-family: Arial, Helvetica, sans-serif;
    font-size: 12px;
}

h1 {
	font-family: Arial, Helvetica, sans-serif;
	text-align: center;
	text-transform: capitalize
}

h2 {
	font-style: italic
}

ul {
	list-style-type: circle
}

/* b { font-family: Arial, sans-serif; font-size: .9em }
span.nagios { font-family: Arial, sans-serif; font-size: .9em } */
b {
	font-size: .9em
}

span.nagios {
	font-size: .9em
}

span.lower {
	text-transform: lowercase
}

.footer {
	font-family: Arial, sans-serif;
	font-style: italic;
	font-size: .7em;
	text-align: right
}

#DIV_CONTENT img {
				
				margin : 5px;
			}
#DIV_CONTENT {
	height:80px; overflow:hidden;  margin:2px 4px 2px 4px
}

.titre {
	text-overflow: ellipsis;
	white-space: nowrap;
	height: 1.1em; 
	overflow: hidden;
	font-weight: bold;
	color: #2244BB;
	text-decoration: none;
}
</style>
<script type="text/javascript">

var listItems; 
var currentTabId = 0;

function afficheInfo(type)
{
	db = openDatabase("Equipe.fr", "1.0", "Items database", 200000);
            
            				function onError(tx, error) {
            				  console.log(error.message);
            				}
            				
            				// Selection des Items :
            				db.transaction(function(tx) {
            				    tx.executeSql("SELECT * FROM Items WHERE read = ? AND type = ?", [false, type], function(tx, result) {
								
								listItems = result.rows;
            				     /* for (var i = 0, item = null; i < result.rows.length; i++) {
            				        item = result.rows.item(i);
									console.log(item['title']);
									
            				        
								  afficheItem(0);
            				      }*/
            				    });
							});
}

function afficheItem(item)
{
	html = '<div class="Notification"><a href="'+item['url']+'" target="_blank" class="titre">'+item['type']+' :'+item['title']+' </a>';
	html += '<div class="content">' + item['text'] + '</div>';
	html += ' </div>';
    $('#DIV_CONTENT').html(html);
	
	// Correction des images 
	$('img[src*=Medias]').attr('src', 'http://img.lequipe.fr' + $('img[src*=Medias]').attr('src') ).attr('height', 60).attr('width', 60);
	
	
	// lecture de l'item 
}

function afficheNext()
{
	currentTabId += 1;
	var item = listItems.item(currentTabId);
	afficheItem(item);
}

function init () {
	console.log(window.location.search);
	var item = eval("a="+decodeURIComponent(window.location.search.substring(1)));
	afficheItem(item);
	afficheInfo(item.type);
}
</script>
</head>
<body onload="init();">
<div class='notification' id="DIV_CONTENT">
<div class="content">Nouvelle alerte !</div>
</div>
<a href="javascript:afficheNext();return false;"> Suivant </a>
</body>
</html>