<!DOCTYPE html>
<html>
    <head>
        <script type="text/javascript" src="jquery-1.4.2.js">
        </script>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <style type="text/css">
            body {
                height: auto;
                max-height: 500px;
                width: 500px;
                background-color: #FFF;
                font-family: Arial, Helvetica, sans-serif;
                font-size: 12px;
            }
            
            a {
                text-decoration: none;
                color: #000;
                cursor: pointer
            }
            
            a:hover, #liens a:hover {
            }
            
            #liens {
                font-size: 11px;
                background: url(http://img.lequipe.fr/img_v5/fond_top_middle.jpg) repeat-x;
                border-top: 0px;
                height: 18px;
                margin-left: auto;
                margin-right: auto;
            }
            
            #liens a {
                background: url(http://img.lequipe.fr/img_v5/icones_png.png?20100527) no-repeat 0px -961px;
                color: #D60000;
                float: left;
                color: white;
                display: inline-block;
                padding: 0px 12px;
            }
            
            #liens a:hover {
            }
            
            #bloc_top {
                background: #FFF;
                border-bottom: 2px solid #d60000
            }
            
            #bloc_top_middle {
                border-top: 0;
                height: 18px;
                margin-left: 0px;
                margin-right: 0px;
                background: url(http://img.lequipe.fr/img_v5/fond_top_middle.jpg) repeat-x
            }
            
            #liens_sites {
                background: url(http://img.lequipe.fr/img_v5/icones_png.png?20100527) no-repeat 0 -961px;
                padding-left: 10px;
                padding-top: 2px;
                padding-bottom: 2px;
                color: #d60000;
                float: left;
            }
            
            #liens_sites a {
                color: #FFF;
                padding: 0 8px;
                display: inline-block
            }
            
            .nav {
                font-size: 11px;
                border-bottom: solid 1px black;
                height: 20px
            }
            
            .onglets {
                background-image: url(http://img.lequipe.fr/medias/commun/navigation_fond_tr.gif)
            }
            
            .lienNav, .lienNavActif {
                background-position: left top;
                background-position: 0px 0px;
                background-repeat: no-repeat;
                border-right: 1px solid #FFFFFF;
                color: #000000;
                height: 20px;
                line-height: 20px;
                padding-left: 7px;
                padding-right: 8px;
                padding-top: 4px;
                padding-bottom: 3px;
                margin: 0px;
                text-align: left;
                background-image: url(http://img.lequipe.fr/medias/commun/navigation_fond_th.gif)
            }
            
            .lienNavActif {
                background-color: #D60000;
                color: #FFFFFF !important;
                font-weight: bold
            }
            
			a#TOUS:hover {
                background-color: #D60000 !important;
                color: #FFF !important
            }

            a#GENERAL:hover {
                background-color: #D60000 !important;
                color: #FFF !important
            }
            
            a#FOOT:hover {
                background-color: #78A130 !important;
                color: #FFF !important
            }
            
            a#AUTO:hover {
                background-color: #5A7984 !important;
                color: #FFF !important
            }
            
            a#TENNIS:hover {
                background-color: #DB7141 !important;
                color: #FFF !important
            }
            
            a#RUGBY:hover {
                background-color: #004C30 !important;
                color: #FFF !important
            }
            
            a#NEXT:hover, a#PREVIOUS:hover {
                background-color: #CCC !important;
                color: #FFF !important
            }
            
            a#BHV:hover {
                background-color: #000084 !important;
                color: #FFF !important
            }
            
            a#CYCLISME:hover {
                background-color: #BDB600 !important;
                color: #FFF !important
            }
            
            a#AUTRES:hover {
                background-color: #5AB6AD !important;
                color: #FFF !important
            }
            
            .nav2 {
                background-color: #F5F5F5;
                border-bottom: 1px solid #EBEBEB;
                font-size: 11px;
                margin-bottom: 6px;
                padding: 2px 4px
            }
            
            .lienNav2 {
            }
            
            .lienNav2Actif {
                text-decoration: none;
                cursor: text;
                color: black !important;
                font-weight: bold
            }
            
            .content {
                font-size: 11px;
                background-color: white;
                margin-top: 20px;
            }
            
            .footer {
                font-size: 10px;
                margin-top: 10px;
                text-align: right
            }
            
            tbody {
                font-size: 10px
            }
            
            img {
                border: 0
            }
            
            .combo {
                margin-bottom: 4px
            }
            
            #RESULTAT, #CLASSEMENT {
                border-collapse: collapse;
                width: 100%
            }
            
            #RESULTAT th, #RESULTAT td, #CLASSEMENT th, #CLASSEMENT td {
                font-size: 11px;
                border-bottom: 1px solid #CCC
            }
            
            #RESULTAT th, #CLASSEMENT th {
                text-align: left
            }
            
            .domicile {
                text-align: right
            }
            
            .score {
                padding: 0 6px 0 6px
            }
            
            .alternate2 {
                background-color: #F5F5F5
            }
            
            .separateur {
                font-size: 0px !important;
                height: 2px;
                overflow: hidden
            }
            
            .DIV_RUBRIQUE {
                float: left;
                width: 98%;
                border: 1px #EBEBEB solid;
                margin: 0px;
                overflow: hidden;
                padding: 5px;
                background-color: white;
            }
            
            .ENTETE {
                font-size: 12px;
                padding: 3px;
                font-weight: bold;
                margin-bottom: 10px;
                background-image: url(http://img.lequipe.fr/medias/commun/navigation_fond_th.gif) no-repeat;
            }
            
            #DIV_CONTENT {
            	overflow: auto;
            }
			
			#DIV_CONTENT img {
				width : 80px;
				margin : 5px;
			}
			
			.title {
				font-size: 140%;
				font-weight: bold;
				color: #2244BB;
			}
			
			.link-to-go {
				background: url(link.png);
				
			}
        </style>
        <script type="text/javascript">
			var db;
			
            function loadDiv (type) {
				
				
				$('#DIV_CONTENT').text("");

				var req = "SELECT * FROM Items WHERE read = ? AND type LIKE ?";
				var categorie = "%";
				var args = [false, categorie];

				if(type == "GENERAL") {
					categorie = "general%";
				} else if(type == "FOOT"){
					categorie = "foot%";
				}else if(type == "AUTO"){
					categorie = "auto%";
				} else if(type == "TENNIS"){
					categorie = "tennis%";
				} else if(type == "RUGBY"){
					categorie = "rugby%";
				} else if(type == "BHV"){
					categorie = "bhv%";
				} else if(type == "CYCLISME"){
					categorie = "cyclisme%";
				} else if(type == "AUTRES"){
					categorie = "autre%";
				} 
				else {
					type = "GENERAL";
				}
				
            	// Selection des Items :
            	db.transaction(function(tx) {
					tx.executeSql(req, [false, categorie], function(tx, result) {
						for (var i = 0, item = null; i < result.rows.length; i++) {
							item = result.rows.item(i);
							console.log(item['title']);
							html = '<a class="title" href="'+item['url']+'" target="_blank">'+item['title']+' </a>';
							html += '<div class="link-to-go"/>';
							html += '<p>' + correctImg(item['text']) + '</p>';
							html += ' <div style="clear:both; height:1px; overflow:hidden; border-top:1px dashed #99BB00; margin:2px 4px 2px 4px"></div>';
							
							$('#DIV_CONTENT').prepend(html);
							
							
							
            			}
            		});
				});
				
				// redimentionnement des images 
				// Correction des images 
		// Correction des images 
				
				loadFooter(type);
				
/*					$('#DIV_CONTENT.img[src*=Medias]').each(		function () {
			$(this).attr('width', 80); // .attr('src', 'http://img.lequipe.fr' + $(this).attr('src') ).
			}); 
	*/

			}

			function correctImg(html) {
				var i = html.indexOf("/Medias/");
				if(i != -1) {
					html = html.substr(0,i)+ 'http://img.lequipe.fr' + html.substr(i);
				}
				return html;
			}
                        
			function loadNavTab() {
				var feeds = chrome.extension.getBackgroundPage().getFeedsList();
				var feedName;
				var navTab;
				
				for(var i = 0; i < feeds.length; i++) {
					if (typeof feeds[i] == "object") {
						feedName = feeds[i].key;
						if(feedName.indexOf("general") == 0) {
							navTab = '<a id="GENERAL" href="#javascript" class="lienNav" onclick="loadDiv(this.id)">Général</a>';
						}
						if(feedName.indexOf("foot") == 0) {
							navTab = '<a id="FOOT" href="#javascript" class="lienNav" onclick="loadDiv(this.id)">Football</a>';
						}
						if(feedName.indexOf("auto") == 0) {
							navTab = '<a id="AUTO" href="#javascript" class="lienNav" onclick="loadDiv(this.id)">Auto</a>';
						}
						if(feedName.indexOf("tennis") == 0) {
							navTab = '<a id="TENNIS" href="#javascript" class="lienNav" onclick="loadDiv(this.id)">Tennis</a>';
						}
						if(feedName.indexOf("rugby") == 0) {
							navTab = '<a id="RUGBY" href="#javascript" class="lienNav" onclick="loadDiv(this.id)">Rugby</a>';
						}
						if(feedName.indexOf("bhv") == 0) {
							navTab = '<a id="BHV" href="#javascript" class="lienNav" onclick="loadDiv(this.id)">Basket/Hand/Volley</a>';
						}
						if(feedName.indexOf("cyclisme") == 0) {
							navTab = '<a id="CYCLISME" href="#javascript" class="lienNav" onclick="loadDiv(this.id)">Cyclisme</a>';
						}
						if(feedName.indexOf("autre") == 0) {
							navTab = '<a id="AUTRES" href="#javascript" class="lienNav" onclick="loadDiv(this.id)">Autres</a>';
						}
						$('#nav').prepend(navTab);
					}
				}
				if(feeds.length>0)
					$('#nav').prepend('<a id="TOUS" href="#javascript" class="lienNav" onclick="loadDiv(this.id)">Tous</a>');
			}
			
                        function getDateEnFrancais(date){
                        
                            var newDate = "";
                            
                            laDate = new Date(date);
                            
                            var minutes = "" + laDate.getMinutes();
                            
                            minutes = minutes.length == 1 ? "0" + minutes : minutes;
                            
                            newDate = laDate.getHours() + "h" + minutes;
                            
                            return newDate;
                        }
                        
                        function loadFooter(nav){
                        
                            var tabFooters = new Array();
                            
                            tabFooters["GENERAL"] = "<a href=\"http://www.lequipe.fr\" target=\"_blank\">Plus d'infos >>></a>";
                            tabFooters["FOOT"] = "<a href=\"http://www.lequipe.fr/Football/index.html\" target=\"_blank\">Plus d'infos Football >>></a>";
                            tabFooters["AUTO"] = "<a href=\"http://www.lequipe.fr/Formule1/index.html\" target=\"_blank\">Plus d'infos Auto/Moto>>></a>";
                            tabFooters["TENNIS"] = "<a href=\"http://www.lequipe.fr/Tennis/index.html\" target=\"_blank\">Plus d'infos Tennis>>></a>";
                            tabFooters["RUGBY"] = "<a href=\"http://www.lequipe.fr/Rugby/index.html\" target=\"_blank\">Plus d'infos Rugby>>></a>";
                            tabFooters["BHV"] = "<a href=\"http://www.lequipe.fr/Basket/index.html\" target=\"_blank\">Plus d'infos Basket/Hand/Volley>>></a>";
                            tabFooters["CYCLISME"] = "<a href=\"http://www.lequipe.fr/Cyclisme/index.html\" target=\"_blank\">Plus d'infos Cyclisme>>></a>";
                            tabFooters["AUTRES"] = "<a href=\"http://www.lequipe.fr/Aussi/index.html\" target=\"_blank\">Plus d'infos Autres Sports>>></a>";
                            
                            $("#footer, #header").html(tabFooters[nav]);
                        }
                    
		function init() {
			db = openDatabase("Equipe.fr", "1.0", "Items database", 200000);
				function onError(tx, error) {
					console.log(error.message);
            	}
			
			
			loadNavTab();
			loadDiv();
		}
        </script>
    </head>
    <body onload='init();'>
        <div id="bloc_top">
            <div id="logo">
                <a href="http://www.lequipe.fr" target="_blank"><img src="http://img.lequipe.fr/Gadgets/iGoogle/img/logo_lequipe.gif" hspace="5" vspace="5"></a>
            </div>
            <div id="bloc_top_middle">
                <div id="liens_sites">
                    <a href="http://www.lequipemag.fr" alt="" target="_blank">lequipemag.fr</a>
                    | <a href="http://www.lequipetv.fr" alt="" target="_blank">lequipetv.fr</a>
                    | <a href="http://www.rtl-lequipe.fr" alt="" target="_blank">rtl-lequipe.fr</a>
                    | <a href="http://www.lequipeauto.fr" alt="" target="_blank">lequipeauto.fr</a>
                </div>
                <div id="rss_top">
                    <a href="www.lequipe.fr/Fonctions/services_RSS.html" title="Les flux RSS de L'Equipe.fr"><img src="http://img.lequipe.fr/img_v5/RSS_top.gif" alt="Les flux RSS de L'Equipe.fr" width="19" height="20"></a>
                </div>
                <div class="onglets">
                    <div id="nav" class="nav">
                       
                    </div>
                </div>
            </div>
        </div>
        <div id="content" class="content">
            <div class="DIV_RUBRIQUE">
                <div class="ENTETE" style="background:#5A7984">
                    <input type="button" onclick="chrome.extension.getBackgroundPage().setReadAllItems()" value="Tout marquer comme lu"></input>
                </div>
				<div id="header" ></div>
                <div id="DIV_CONTENT">
                </div>
				<div id="footer" ></div>
                
            </div>
        </div>
    </body>
</html>
